# `README.md`

```markdown
# üõí Churn Prediction for E-Commerce

End-to-end ML-–ø—Ä–æ–µ–∫—Ç: –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –æ—Ç—Ç–æ–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å—ã—Ä—ã—Ö event-–ª–æ–≥–æ–≤ (–∫–ª–∏–∫–∏, –ø–æ–∫—É–ø–∫–∏, –ø—Ä–æ—Å–º–æ—Ç—Ä—ã).  
–°–∏—Å—Ç–µ–º–∞ –≤–∫–ª—é—á–∞–µ—Ç –ø–æ–ª–Ω—ã–π —Ü–∏–∫–ª: –¥–∞–Ω–Ω—ã–µ ‚Üí —Ñ–∏—á–∏ ‚Üí –º–æ–¥–µ–ª—å ‚Üí –º–µ—Ç—Ä–∏–∫–∏ ‚Üí –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è ‚Üí –¥–∞—à–±–æ—Ä–¥.

---

## üìå –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

**–¶–µ–ª—å:** –ø—Ä–µ–¥—Å–∫–∞–∑–∞—Ç—å, –∫–∞–∫–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω–∞ —Å –≤—ã—Å–æ–∫–æ–π –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ—Å—Ç–∞–Ω—É—Ç –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å—Å—è (churn).  
**–î–∞–Ω–Ω—ã–µ:** –ª–æ–≥–∏ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (–∫–ª–∏–∫–∏, –ø–æ–∫—É–ø–∫–∏, —Å–æ–±—ã—Ç–∏—è –≤ —Å–µ—Å—Å–∏—è—Ö) –∑–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–µ—Å—è—Ü–µ–≤ (2019-Oct ‚Äì 2020-Feb).  
**–í—ã—Ö–æ–¥:** –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π Streamlit-–¥–∞—à–±–æ—Ä–¥ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –º–µ—Ç—Ä–∏–∫ –º–æ–¥–µ–ª–∏ –∏ –ø–æ–ª—É—á–µ–Ω–∏—è –ø—Ä–æ–≥–Ω–æ–∑–∞ –ø–æ –ª—é–±–æ–º—É `user_id`.

---

## üöÄ –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª

- üìÇ **–û–±—Ä–∞–±–æ—Ç–∫–∞ —Å—ã—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö**: –∞–≥—Ä–µ–≥–∞—Ü–∏—è —Å–æ–±—ã—Ç–∏–π (click, purchase, session) –≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–∏.
- üèó **Feature Engineering**:
  - –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å (clicks, purchases),
  - –≤–æ–≤–ª–µ—á—ë–Ω–Ω–æ—Å—Ç—å (avg_session_time, days_since_last_visit),
  - —Ü–µ–Ω–Ω–æ—Å—Ç—å (avg_order_value, conversion_rate, high_value_user),
  - derived-features (order_value_per_time, engagement_score –∏ —Ç. –¥.).
- üìä **–ú–æ–¥–µ–ª–∏**:
  - LightGBM (–æ—Å–Ω–æ–≤–Ω–∞—è),
  - XGBoost,
  - Logistic Regression (–±–∞–∑–æ–≤—ã–π –±–µ–π–∑–ª–∞–π–Ω).
- üîç **–ú–µ—Ç—Ä–∏–∫–∏**:
  - ROC-AUC, PR-AUC, F1-score,
  - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–¥–±–æ—Ä –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–≥–æ –ø–æ—Ä–æ–≥–∞.
- üìà **–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è**:
  - Feature Importances,
  - SHAP-–≥—Ä–∞—Ñ–∏–∫–∏ (—á—Ç–æ –≤–ª–∏—è–µ—Ç –Ω–∞ –æ—Ç—Ç–æ–∫).
- üñ• **Dashboard (Streamlit)**:
  - ROC –∏ PR –∫—Ä–∏–≤—ã–µ,
  - —Ç–∞–±–ª–∏—Ü–∞ –≤–∞–∂–Ω–æ—Å—Ç–∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤,
  - –æ–±—ä—è—Å–Ω–µ–Ω–∏—è SHAP,
  - –ø–æ–∏—Å–∫ –ø–æ `user_id` ‚Üí –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å churn,
  - –≤—ã–≥—Ä—É–∑–∫–∞ —Å–ø–∏—Å–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –Ω–∞–∏–±–æ–ª—å—à–∏–º —Ä–∏—Å–∫–æ–º –æ—Ç—Ç–æ–∫–∞.

---

## üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```

  ‚îú‚îÄ‚îÄ configs/
  ‚îÇ   ‚îî‚îÄ‚îÄ config.yaml          # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (–ø—É—Ç–∏ –∫ –¥–∞–Ω–Ω—ã–º, –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –º–æ–¥–µ–ª–µ–π)
  ‚îú‚îÄ‚îÄ data/
  ‚îÇ   ‚îú‚îÄ‚îÄ 2019-Oct.csv         # –°—ã—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ
  ‚îÇ   ‚îú‚îÄ‚îÄ 2019-Nov.csv
  ‚îÇ   ‚îú‚îÄ‚îÄ 2019-Dec.csv
  ‚îÇ   ‚îú‚îÄ‚îÄ 2020-Jan.csv
  ‚îÇ   ‚îî‚îÄ‚îÄ 2020-Feb.csv
  ‚îú‚îÄ‚îÄ models/
  ‚îÇ   ‚îú‚îÄ‚îÄ model.pkl            # –°–æ—Ö—Ä–∞–Ω—ë–Ω–Ω–∞—è –º–æ–¥–µ–ª—å
  ‚îÇ   ‚îú‚îÄ‚îÄ metrics.json         # –ú–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞
  ‚îÇ   ‚îú‚îÄ‚îÄ feature\_importances.csv
  ‚îÇ   ‚îî‚îÄ‚îÄ test\_predictions.csv
  ‚îú‚îÄ‚îÄ src/
  ‚îÇ   ‚îú‚îÄ‚îÄ features/
  ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ build\_features.py
  ‚îÇ   ‚îú‚îÄ‚îÄ models/
  ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ train\_model.py   # –û—Å–Ω–æ–≤–Ω–æ–π —Å–∫—Ä–∏–ø—Ç –æ–±—É—á–µ–Ω–∏—è
  ‚îÇ   ‚îî‚îÄ‚îÄ visualization/
  ‚îÇ       ‚îî‚îÄ‚îÄ dashboard.py     # Streamlit –¥–∞—à–±–æ—Ä–¥
  ‚îî‚îÄ‚îÄ README.md

````

---

## ‚öôÔ∏è –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

### 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –∏ –ø–µ—Ä–µ–π—Ç–∏ –≤ –ø–∞–ø–∫—É
```bash
git clone https://github.com/username/churn-prediction.git
cd churn-prediction
````

### 2. –°–æ–∑–¥–∞—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ –∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

```bash
python -m venv .venv
.venv\Scripts\activate
pip install -r requirements.txt
```

### 3. –û–±—É—á–∏—Ç—å –º–æ–¥–µ–ª—å

```bash
python -m src.models.train_model --config configs/config.yaml
```

–ü–æ—Å–ª–µ –æ–±—É—á–µ–Ω–∏—è –≤ –ø–∞–ø–∫–µ `models/` –ø–æ—è–≤—è—Ç—Å—è:

* `model.pkl` ‚Äî —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω–∞—è –º–æ–¥–µ–ª—å,
* `metrics.json` ‚Äî –º–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞,
* `feature_importances.csv` ‚Äî –≤–∞–∂–Ω–æ—Å—Ç—å –ø—Ä–∏–∑–Ω–∞–∫–æ–≤,
* `test_predictions.csv` ‚Äî –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –Ω–∞ —Ç–µ—Å—Ç–µ.

### 4. –ó–∞–ø—É—Å—Ç–∏—Ç—å –¥–∞—à–±–æ—Ä–¥

```bash
streamlit run src/visualization/dashboard.py
```

---

## üìä –ü—Ä–∏–º–µ—Ä –º–µ—Ç—Ä–∏–∫

```json
{
  "roc_auc": 0.88,
  "pr_auc": 0.78,
  "f1": 0.84,
  "best_threshold": 0.85,
  "n_test": 391055,
  "labels_source": "synthetic_inactive_days>30"
}
```

* **ROC-AUC = 0.88** ‚Üí –º–æ–¥–µ–ª—å —Ö–æ—Ä–æ—à–æ —Ä–∞–∑–ª–∏—á–∞–µ—Ç churn / non-churn.
* **PR-AUC = 0.78** ‚Üí –≤—ã—Å–æ–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ –¥–∞–∂–µ –ø—Ä–∏ –¥–∏—Å–±–∞–ª–∞–Ω—Å–µ –∫–ª–∞—Å—Å–æ–≤.
* **F1 = 0.84** ‚Üí –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π.

---

## üõ† –°—Ç–µ–∫ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π

* **Python 3.10+**
* **pandas, numpy, scikit-learn** ‚Äî –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö
* **LightGBM, XGBoost** ‚Äî ML-–º–æ–¥–µ–ª–∏
* **SHAP** ‚Äî –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è
* **Streamlit, matplotlib, seaborn** ‚Äî –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è
* **PyYAML** ‚Äî —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π
